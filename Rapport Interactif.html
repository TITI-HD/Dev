<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rapport Interactif : Supervision WordPress</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutrals (Slate, Stone, with a Sky blue accent) -->
    <!-- Application Structure Plan: The application is designed as a single-page scrolling experience with a sticky top navigation bar. This structure was chosen over a simple document layout to create a narrative flow, allowing users to explore the report thematically (from high-level architecture to detailed script analysis and final recommendations). The nav bar provides immediate access to any section, catering to both linear readers and those looking for specific information. This enhances usability by making a dense technical report easily digestible and navigable. Key interactions include component highlighting, dynamic chart updates, and categorized content displays to facilitate understanding. -->
    <!-- Visualization & Content Choices: 
        1. Architecture Diagram: Report Info (Global architecture) -> Goal (Organize/Inform) -> Viz (HTML/CSS Flexbox Cards) -> Interaction (Click on a card to display its description) -> Justification (Visually represents the modular nature of the system and component relationships in a more engaging way than text) -> Library/Method (Vanilla JS + Tailwind).
        2. Performance Chart: Report Info (Test script results) -> Goal (Compare/Inform) -> Viz (Bar Chart) -> Interaction (Dropdown to simulate different test loads and update chart data dynamically) -> Justification (Turns static performance numbers into a clear, comparative visualization, making it easier to grasp the system's capabilities) -> Library/Method (Chart.js).
        3. Dependency List: Report Info (requirements.txt) -> Goal (Organize) -> Viz (Categorized list with icons) -> Interaction (None, static display) -> Justification (Structures a simple list into meaningful categories, adding context to each dependency's role) -> Library/Method (HTML/Tailwind).
        4. Strengths/Recommendations: Report Info (Synthesis section) -> Goal (Inform/Synthesize) -> Viz (Two-column card layout) -> Interaction (Hover effects) -> Justification (Presents a balanced summary that is quick to scan and visually appealing) -> Library/Method (HTML/Tailwind).
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
            color: #334155; /* slate-700 */
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .nav-link {
            transition: color 0.2s, border-bottom-color 0.2s;
        }
        .nav-link.active {
            color: #0284c7; /* sky-600 */
            border-bottom-color: #0284c7;
        }
        .component-card {
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .component-card:hover {
            transform: translateY(-4px);
        }
        .component-card.active {
            transform: translateY(-4px);
            box-shadow: 0 0 0 3px #38bdf8; /* sky-400 */
            border-color: #0284c7;
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-50 shadow-sm">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex-shrink-0">
                    <h1 class="text-xl font-bold text-slate-800">Rapport Interactif</h1>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#overview" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-600 hover:text-sky-600 border-b-2 border-transparent">Vue d'ensemble</a>
                        <a href="#architecture" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-600 hover:text-sky-600 border-b-2 border-transparent">Architecture</a>
                        <a href="#analysis" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-600 hover:text-sky-600 border-b-2 border-transparent">Analyse des Scripts</a>
                        <a href="#performance" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-600 hover:text-sky-600 border-b-2 border-transparent">Performance</a>
                        <a href="#synthesis" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-600 hover:text-sky-600 border-b-2 border-transparent">Synthèse</a>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
        
        <section id="overview" class="scroll-mt-20">
            <div class="text-center">
                <h2 class="text-3xl font-bold tracking-tight text-slate-900 sm:text-4xl">Projet de Supervision WordPress</h2>
                <p class="mt-4 text-lg leading-8 text-slate-600 max-w-3xl mx-auto">Une analyse approfondie d'un système robuste et automatisé pour la surveillance, la sauvegarde et la restauration d'un site WordPress.com.</p>
            </div>

            <div class="mt-12 grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h3 class="text-lg font-semibold text-slate-800">Contexte du Projet</h3>
                    <p class="mt-2 text-slate-600">Le projet s'appuie sur les APIs publiques et les flux de données pour extraire et archiver le contenu, en contournant les limitations de WordPress.com. L'automatisation est assurée par GitHub Actions.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h3 class="text-lg font-semibold text-slate-800">Objectifs du Rapport</h3>
                    <p class="mt-2 text-slate-600">Analyser le code source, expliquer la logique métier, évaluer la robustesse et la sécurité de la solution, et proposer des recommandations d'amélioration.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h3 class="text-lg font-semibold text-slate-800">Éléments Analysés</h3>
                    <ul class="mt-2 space-y-1 text-slate-600">
                        <li>▶ 6 Scripts Python principaux</li>
                        <li>▶ 7 Dépendances logicielles</li>
                        <li>▶ 3 Fichiers de configuration</li>
                    </ul>
                </div>
            </div>
        </section>

        <hr class="my-16 border-slate-200">

        <section id="architecture" class="scroll-mt-20">
            <div class="text-center">
                <h2 class="text-3xl font-bold tracking-tight text-slate-900 sm:text-4xl">Architecture du Système</h2>
                <p class="mt-4 text-lg leading-8 text-slate-600 max-w-3xl mx-auto">La solution est articulée autour de plusieurs scripts Python modulaires. Cliquez sur un composant pour voir sa description.</p>
            </div>

            <div class="mt-12">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 items-start" id="architecture-diagram">
                    <div class="component-card cursor-pointer border-2 border-slate-200 bg-white p-6 rounded-lg shadow-sm" data-component="monitor">
                        <h3 class="text-xl font-semibold text-slate-800">Surveillance</h3>
                        <p class="text-sm text-slate-500 mt-1">monitor.py</p>
                    </div>
                    <div class="component-card cursor-pointer border-2 border-slate-200 bg-white p-6 rounded-lg shadow-sm" data-component="backup">
                        <h3 class="text-xl font-semibold text-slate-800">Sauvegarde</h3>
                        <p class="text-sm text-slate-500 mt-1">backup.py</p>
                    </div>
                    <div class="component-card cursor-pointer border-2 border-slate-200 bg-white p-6 rounded-lg shadow-sm" data-component="restore">
                        <h3 class="text-xl font-semibold text-slate-800">Restauration</h3>
                        <p class="text-sm text-slate-500 mt-1">restore.py</p>
                    </div>
                </div>
                <div id="architecture-description" class="mt-8 bg-sky-50 border-l-4 border-sky-500 text-sky-800 p-6 rounded-r-lg min-h-[100px] flex items-center justify-center transition-opacity duration-300 opacity-0">
                    <p class="text-center italic">Sélectionnez un composant ci-dessus.</p>
                </div>
            </div>
        </section>
        
        <hr class="my-16 border-slate-200">

        <section id="analysis" class="scroll-mt-20">
            <div class="text-center">
                <h2 class="text-3xl font-bold tracking-tight text-slate-900 sm:text-4xl">Analyse Détaillée des Scripts</h2>
                <p class="mt-4 text-lg leading-8 text-slate-600 max-w-3xl mx-auto">Exploration de la logique et de l'exécution simulée des composants centraux.</p>
            </div>
            
            <div class="mt-12">
                <div id="script-analysis-content" class="bg-white p-6 md:p-8 rounded-lg shadow-lg">
                    <h3 id="script-title" class="text-2xl font-bold text-slate-800">monitor.py : Le Cœur de la Surveillance</h3>
                    <p id="script-description" class="mt-2 text-slate-600">Ce script est le composant central du système. Il orchestre plusieurs vérifications critiques (disponibilité, intégrité, sécurité) et déclenche des alertes par e-mail en cas d'anomalie. Il peut également initier une sauvegarde avant de lancer ses propres vérifications.</p>
                    
                    <div class="mt-6 bg-slate-800 rounded-lg p-4 font-mono text-sm text-white overflow-x-auto">
                        <p class="text-slate-400 mb-2">> Exécution simulée :</p>
                        <pre><code id="script-output">[2025-08-31 16:25:10] Lancement sauvegarde...
[2025-08-31 16:25:11] SUCCÈS sauvegarde homepage: homepage_...
[2025-08-31 16:25:12] SUCCÈS sauvegarde rss: rss_...
[2025-08-31 16:25:13] === Fin sauvegarde: 3/3 réussies ===
[2025-08-31 16:25:13] === DÉMARRAGE SURVEILLANCE ===
[2025-08-31 16:25:14] Site accessible ✅
[2025-08-31 16:25:14] Vérification d'intégrité...
[2025-08-31 16:25:15] Référence créée : comments
[2025-08-31 16:25:15] Recherche de patterns suspects...
[2025-08-31 16:25:16] Aucun problème détecté ✅
[2025-08-31 16:25:16] SUCCES: Alerte envoyée
[2025-08-31 16:25:16] === FIN SURVEILLANCE ===</code></pre>
                    </div>
                </div>
            </div>
        </section>

        <hr class="my-16 border-slate-200">

        <section id="performance" class="scroll-mt-20">
             <div class="text-center">
                <h2 class="text-3xl font-bold tracking-tight text-slate-900 sm:text-4xl">Dépendances et Performance</h2>
                <p class="mt-4 text-lg leading-8 text-slate-600 max-w-3xl mx-auto">Analyse des bibliothèques logicielles et des résultats des tests de performance.</p>
            </div>

            <div class="mt-12 grid grid-cols-1 lg:grid-cols-2 gap-12">
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h3 class="text-xl font-semibold text-slate-800 mb-4">Dépendances du Projet</h3>
                    <ul class="space-y-3">
                        <li class="flex items-start"><span class="text-sky-500 mr-3 text-xl">❖</span><div><strong class="font-semibold">requests</strong>: Pilier pour toutes les requêtes HTTP vers le site WordPress.</div></li>
                        <li class="flex items-start"><span class="text-sky-500 mr-3 text-xl">❖</span><div><strong class="font-semibold">flask</strong>: Micro-framework pour l'application web de test d'authentification.</div></li>
                        <li class="flex items-start"><span class="text-sky-500 mr-3 text-xl">❖</span><div><strong class="font-semibold">bandit</strong>: Outil d'analyse statique pour la sécurité du code Python.</div></li>
                        <li class="flex items-start"><span class="text-sky-500 mr-3 text-xl">❖</span><div><strong class="font-semibold text-slate-500">twilio, gnupg, matplotlib</strong>: Dépendances présentes mais non utilisées, suggérant des fonctionnalités potentielles (alertes SMS, chiffrement, rapports graphiques).</div></li>
                    </ul>
                </div>
                <div>
                     <div class="bg-white p-6 rounded-lg shadow-md">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-semibold text-slate-800">Résultats des Tests de Charge</h3>
                            <select id="load-test-selector" class="rounded-md border-slate-300 shadow-sm focus:border-sky-500 focus:ring-sky-500">
                                <option value="50">50 Requêtes</option>
                                <option value="100" selected>100 Requêtes</option>
                                <option value="200">200 Requêtes</option>
                            </select>
                        </div>
                        <div class="chart-container">
                            <canvas id="performanceChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <hr class="my-16 border-slate-200">

        <section id="synthesis" class="scroll-mt-20">
            <div class="text-center">
                <h2 class="text-3xl font-bold tracking-tight text-slate-900 sm:text-4xl">Synthèse et Recommandations</h2>
                <p class="mt-4 text-lg leading-8 text-slate-600 max-w-3xl mx-auto">Bilan des points forts de la solution et pistes pour des améliorations futures.</p>
            </div>

            <div class="mt-12 grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-white p-6 rounded-lg shadow-md border-t-4 border-green-500">
                    <h3 class="text-xl font-semibold text-slate-800 mb-4">Points Forts de la Solution</h3>
                    <ul class="space-y-3 text-slate-600">
                        <li class="flex items-start"><span class="text-green-500 mr-3 mt-1">✔</span><span><strong class="font-semibold">Modularité :</strong> Code bien séparé en modules avec des responsabilités claires.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 mt-1">✔</span><span><strong class="font-semibold">Sécurité :</strong> Bonnes pratiques comme l'utilisation de variables d'environnement et la vérification d'intégrité par hash.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 mt-1">✔</span><span><strong class="font-semibold">Robustesse :</strong> Bonne gestion des erreurs réseau qui rend les scripts résilients.</span></li>
                        <li class="flex items-start"><span class="text-green-500 mr-3 mt-1">✔</span><span><strong class="font-semibold">Automatisation :</strong> Conception orientée vers l'exécution via des workflows CI/CD.</span></li>
                    </ul>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md border-t-4 border-yellow-500">
                    <h3 class="text-xl font-semibold text-slate-800 mb-4">Axes d'Amélioration Potentiels</h3>
                    <ul class="space-y-3 text-slate-600">
                        <li class="flex items-start"><span class="text-yellow-500 mr-3 mt-1">💡</span><span><strong class="font-semibold">Chiffrement :</strong> Utiliser `python-gnupg` pour chiffrer les sauvegardes stockées.</span></li>
                        <li class="flex items-start"><span class="text-yellow-500 mr-3 mt-1">💡</span><span><strong class="font-semibold">Alertes Multi-canaux :</strong> Intégrer `twilio` pour des alertes par SMS en cas d'incident critique.</span></li>
                        <li class="flex items-start"><span class="text-yellow-500 mr-3 mt-1">💡</span><span><strong class="font-semibold">Tests Unitaires :</strong> Ajouter des tests unitaires pour garantir la non-régression du code.</span></li>
                        <li class="flex items-start"><span class="text-yellow-500 mr-3 mt-1">💡</span><span><strong class="font-semibold">Journalisation :</strong> Standardiser la journalisation avec le module `logging` pour une meilleure centralisation.</span></li>
                    </ul>
                </div>
            </div>
        </section>

    </main>
    
    <footer class="bg-slate-800 text-slate-300 mt-16">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-6 text-center">
            <p>&copy; 2025 - Rapport généré par Gemini.</p>
        </div>
    </footer>

<script>
document.addEventListener('DOMContentLoaded', () => {

    const architectureData = {
        monitor: {
            title: "monitor.py : Le Cœur de la Surveillance",
            description: "Ce script est le composant central du système. Il orchestre plusieurs vérifications critiques (disponibilité, intégrité, sécurité) et déclenche des alertes par e-mail en cas d'anomalie. Il peut également initier une sauvegarde avant de lancer ses propres vérifications.",
            output: `[2025-08-31 16:25:10] Lancement sauvegarde...
[2025-08-31 16:25:11] SUCCÈS sauvegarde homepage: homepage_...
[2025-08-31 16:25:12] SUCCÈS sauvegarde rss: rss_...
[2025-08-31 16:25:13] === Fin sauvegarde: 3/3 réussies ===
[2025-08-31 16:25:13] === DÉMARRAGE SURVEILLANCE ===
[2025-08-31 16:25:14] Site accessible ✅
[2025-08-31 16:25:14] Vérification d'intégrité...
[2025-08-31 16:25:15] Référence créée : comments
[2025-08-31 16:25:15] Recherche de patterns suspects...
[2025-08-31 16:25:16] Aucun problème détecté ✅
[2025-08-31 16:25:16] SUCCES: Alerte envoyée
[2025-08-31 16:25:16] === FIN SURVEILLANCE ===`
        },
        backup: {
            title: "backup.py : La Stratégie de Sauvegarde",
            description: "Dédié à la sauvegarde du contenu public (accueil, RSS, commentaires). Crée des archives accompagnées de métadonnées (hash, taille, date) pour l'intégrité et nettoie automatiquement les anciens fichiers de plus de 7 jours pour gérer l'espace de stockage.",
            output: `[2025-08-31 16:30:01] === Début sauvegarde WordPress ===
[2025-08-31 16:30:02] SUCCÈS sauvegarde homepage: homepage_...
[2025-08-31 16:30:03] SUCCÈS sauvegarde rss: rss_...
[2025-08-31 16:30:03] SUCCÈS sauvegarde comments: comments_...
[2025-08-31 16:30:03] === Fin sauvegarde: 3/3 réussies ===
[2025-08-31 16:30:03] Supprimé ancien fichier: homepage_...
[2025-08-31 16:30:03] Supprimé ancien fichier: ...meta.json`
        },
        restore: {
            title: "restore.py : Le Processus de Restauration",
            description: "Gère la copie des fichiers sauvegardés vers un répertoire de restauration. Avant chaque copie, il vérifie l'intégrité du fichier en comparant son hash avec les métadonnées. Un rapport JSON est généré à la fin pour un audit complet de l'opération.",
            output: `[2025-08-31 16:35:45] INFO: 15 sauvegardes trouvées
[2025-08-31 16:35:45] SUCCES: Intégrité vérifiée: homepage_...
[2025-08-31 16:35:45] SUCCES: Fichier restauré: homepage_...
...
[2025-08-31 16:35:46] ERREUR: Hash mismatch: comments_corrompu_...
[2025-08-31 16:35:46] ERREUR: Impossible de restaurer comments_corrompu_...
...
[2025-08-31 16:35:47] SUCCES: Restauration terminée: 14/15 fichiers restaurés`
        }
    };

    const componentCards = document.querySelectorAll('.component-card');
    const descriptionBox = document.getElementById('architecture-description');
    const scriptTitle = document.getElementById('script-title');
    const scriptDescription = document.getElementById('script-description');
    const scriptOutput = document.getElementById('script-output');

    componentCards.forEach(card => {
        card.addEventListener('click', () => {
            const componentKey = card.dataset.component;
            const data = architectureData[componentKey];

            componentCards.forEach(c => c.classList.remove('active'));
            card.classList.add('active');
            
            descriptionBox.innerHTML = `<p>${data.description}</p>`;
            descriptionBox.style.opacity = '1';

            scriptTitle.textContent = data.title;
            scriptDescription.textContent = data.description;
            scriptOutput.textContent = data.output;
        });
    });

    const sections = document.querySelectorAll('section');
    const navLinks = document.querySelectorAll('.nav-link');

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href').substring(1) === entry.target.id) {
                        link.classList.add('active');
                    }
                });
            }
        });
    }, { rootMargin: '-50% 0px -50% 0px' });

    sections.forEach(section => {
        observer.observe(section);
    });

    const performanceData = {
        '50': { time: 4.2, avg: 0.08, rps: 11.9 },
        '100': { time: 8.45, avg: 0.08, rps: 11.83 },
        '200': { time: 16.5, avg: 0.08, rps: 12.1 }
    };

    let performanceChart;
    const ctx = document.getElementById('performanceChart').getContext('2d');

    function createOrUpdateChart(requests) {
        const data = performanceData[requests];
        const chartData = {
            labels: ['Temps total (s)', 'Requêtes / seconde'],
            datasets: [{
                label: `Test de charge (${requests} requêtes)`,
                data: [data.time, data.rps],
                backgroundColor: ['#38bdf8', '#0ea5e9'],
                borderColor: ['#0284c7', '#0369a1'],
                borderWidth: 1
            }]
        };

        if (performanceChart) {
            performanceChart.data = chartData;
            performanceChart.options.plugins.title.text = `Test de charge (${requests} requêtes)`;
            performanceChart.update();
        } else {
            performanceChart = new Chart(ctx, {
                type: 'bar',
                data: chartData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    scales: {
                        x: { beginAtZero: true }
                    },
                    plugins: {
                        legend: { display: false },
                        title: {
                            display: true,
                            text: `Test de charge (${requests} requêtes)`,
                            font: { size: 16 },
                            color: '#1e293b'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.x !== null) {
                                        label += context.parsed.x.toFixed(2);
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }
    }

    const loadTestSelector = document.getElementById('load-test-selector');
    loadTestSelector.addEventListener('change', (e) => {
        createOrUpdateChart(e.target.value);
    });

    createOrUpdateChart(loadTestSelector.value);

});
</script>

</body>
</html>
