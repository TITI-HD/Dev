name: üîç Surveillance WordPress.com

on:
  schedule:
    - cron: "*/30 * * * *"   # V√©rifie toutes les 30 minutes
  workflow_dispatch:          # Ex√©cution manuelle possible

jobs:
  monitor:
    runs-on: ubuntu-latest

    steps:
      - name: üì• R√©cup√©ration du d√©p√¥t
        uses: actions/checkout@v3

      - name: üêç Installer Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.11"

      - name: üì¶ Installer les d√©pendances
        run: pip install requests

      - name: üöÄ Ex√©cuter le script de surveillance
        env:
          SITE_URL: ${{ secrets.SITE_URL }}
          ALERT_EMAIL: ${{ secrets.ALERT_EMAIL }}
          SMTP_SERVER: ${{ secrets.SMTP_SERVER }}
          SMTP_PORT: ${{ secrets.SMTP_PORT }}
          SMTP_USER: ${{ secrets.SMTP_USER }}
          SMTP_PASS: ${{ secrets.SMTP_PASS }}
        run: python monitor.py